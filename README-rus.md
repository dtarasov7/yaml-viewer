# YAML TUI Viewer

Консольная **TUI**‑утилита (на базе `curses`) для просмотра **больших YAML файлов** в виде интерактивного дерева.
Поддерживает **ленивую загрузку**, **поиск**, **фильтрацию**, режим **wrap** и базовые защиты от «тяжёлых» YAML/regex сценариев.

> В репозитории лежит один исполняемый файл: `yaml-viewer.py` (см. также вариант с расширенными комментариями: `yaml-viewer.commented.py`).

## Возможности

- Просмотр YAML как дерева (слои/узлы/листья).
- Ленивая загрузка объектов (подходит для очень больших файлов с множеством документов/объектов).
- Просмотр значения листового узла в отдельном окне с прокруткой.
- Поиск:
  - `s` — поиск по текущему полю/узлу (по отображаемому тексту).
  - `F` — глобальный поиск по всем загруженным/доступным узлам (с раскрытием пути к найденному).
- Фильтрация полей (`f`): выбор набора leaf‑полей, которые нужно показывать.
- Режим `wrap` (`w`) для удобного чтения длинных строк.
- Навигация по объектам/позициям (`g`, Home/End, PgUp/PgDn и пр.).

## Быстрый старт

```bash
python3 yaml-viewer.py config.yaml
# или несколько файлов
python3 yaml-viewer.py a.yaml b.yaml
```

### Требования
- Python 3.8+ (рекомендуется 3.10+)
- Linux/macOS терминал с поддержкой `curses`
- Windows: возможна работа через WSL (нативно `curses` может отсутствовать)

## Управление (горячие клавиши)

Основной экран:

- `q` / `Esc` — выход
- `↑/↓` или `j/k` — вверх/вниз
- `n` / `p` — «страница» вниз/вверх (быстрое перемещение)
- `→` или `l` — раскрыть текущий узел
- `←` — свернуть текущий узел
- `Enter` — открыть:  
  - если лист — просмотр значения  
  - если объект/коллекция — toggle expand/collapse
- `w` — wrap on/off (перестраивает список)
- `a` / `z` — раскрыть/свернуть *текущий объект* (уровнем глубже)
- `A` / `Z` — раскрыть всё загруженное / свернуть всё
- `g` — перейти к объекту (номер)
- `Home` / `End` — первый / последний объект
- `PageDown` / `PageUp` — следующий / предыдущий объект
- `s` — поиск (по текущему полю)
- `F` — глобальный поиск
- `f` — фильтр полей

Окно просмотра значения (leaf value):

- `q` / `Esc` — закрыть
- `↑/↓/←/→` — прокрутка (←/→ только если wrap выключен)
- `w` — wrap on/off

## Структура проекта

```
.
├── yaml-viewer.py
├── yaml-viewer.commented.py   # тот же код, но с расширенными docstring/комментариями
└── docs
    ├── ARCHITECTURE.md
    └── diagrams
        ├── components.puml
        ├── classes.puml
        └── sequences.puml
```

## Архитектура

Ключевые сущности:

- `YamlFile` — работа с YAML‑файлом: чтение, разбиение документов, безопасный парсинг.
- `YamlNode` — узел дерева (ключ, значение, дети, раскрытие/сворачивание).
- `YamlTuiViewer` — UI/состояние: плоский список для отрисовки, скролл, курсор, поиск/фильтр.

Диаграммы PlantUML: см. `docs/diagrams/*.puml`.

## Безопасность и ограничения

Внутри кода есть «защитные» проверки:
- валидация пути к файлу;
- ограничение «опасных» YAML‑структур;
- ограничение сложности регулярных выражений и таймауты.

Тем не менее, **не открывайте YAML из недоверенных источников**, если от этого зависит безопасность системы.

## Лицензия

Добавьте здесь вашу лицензию (например MIT/Apache-2.0).
